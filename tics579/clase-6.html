<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Alfonso Tobar-Arancibia">
  <title>Clases UAI – TICS-579-Deep Learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-673c2e7d040da7fd4b9d655d29f657a0.css">
  <link rel="stylesheet" href="../logo.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">TICS-579-Deep Learning</h1>
  <p class="subtitle">Clase 6: Training Tips &amp; Tricks</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Alfonso Tobar-Arancibia 
</div>
        <p class="quarto-title-affiliation">
            <a href="mailto:alfonso.tobar.a@edu.uai.cl" class="email">alfonso.tobar.a@edu.uai.cl</a>
          </p>
    </div>
</div>

</section>
<section id="potenciales-problemas-al-entrenar-un-modelo" class="slide level2 smaller">
<h2>Potenciales problemas al Entrenar un Modelo</h2>
<blockquote>
<p>El entrenamiento de un modelo tiene demasiadas variables que pueden influir en el éxito del modelo. Algunos aspectos relevantes a los que hay que poner énfasis al momento de entrenar:</p>
</blockquote>
<ul>
<li>Lidiar con Variables Categóricas</li>
<li>Escala de las Variables</li>
<li>Determinar convergencia</li>
<li>Combatir el Overfitting</li>
<li>Determinar Generalización</li>
<li>Optimizar Recursos Computacionales/Hardware.</li>
<li>Prevenir problemas de Vanishing Gradient y Exploding Gradients.</li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Muchas de las técnicas que veremos acá permiten abordar mejoras en nuestros modelos para uno o más aspectos de los mencionados anteriormente.</p>
</div>
</div>
</div>
</section>
<section id="categorical-variables-one-hot-encoding" class="slide level2 smaller">
<h2>Categorical Variables: One Hot Encoding</h2>
<p>Hasta ahora hemos asumido que las variables de entrada son numéricas. Pero en la práctica es muy común encontrarse con variables categóricas. En Deep Learning existen dos técnicas para lidiar con este tipo de variables: One-Hot-Encoding y el uso de Embeddings.</p>
<div class="columns">
<div class="column">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>📋 One-Hot-Encoding</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>Permite una representación dispersa (sparse) de las variables categóricas. Consiste en crear una columna por cada categoría, y asignar un 1 o un 0 dependiendo si la instancia pertenece o no a dicha categoría.</p></li>
<li><p>Es una representación estática sin parámetros entrenables asociados.</p></li>
<li><p>Genera tantas columnas/features nuevas como categorías existan en la variable original. Por lo tanto, puede generar problemas de dimensionalidad si existen muchas categorías.</p></li>
</ul>
</div>
</div>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-5/ohe_example.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="img/clase-5/ohe_example.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></a></p>
</figure>
</div>
</div></div>
</section>
<section id="categorical-variables-embeddings" class="slide level2 smaller">
<h2>Categorical Variables: Embeddings</h2>
<div class="columns">
<div class="column">
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>🗞️ Embeddings</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>Un embedding es una representación numérica de un objeto (palabra, imagen, nodo, etc.) en un espacio vectorial de menor dimensión que captura sus características y relaciones de manera útil para un modelo de machine learning.</p></li>
<li><p>En lugar de trabajar con las categorías crudas, los <strong>embeddings</strong> convierten esos datos en vectores de números reales. De esta forma, objetos similares quedan representados por vectores cercanos.</p></li>
<li><p>Los vectores son aprendidos por el modelo durante el entrenamiento, de tal manera que la representación aprendida es la optima para el problema específico a resolver. Es decir, agrega parámetros entrenables al modelo.</p></li>
</ul>
</div>
</div>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-5/emb_example.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="img/clase-5/emb_example.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div></div>
<p>En Pytorch esto se puede realizar mediante: <code>nn.Embedding()</code>.</p>
<div style="font-size: 150%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a>nn.Embedding(num_embeddings, embedding_dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>num_embeddings</strong>: Corresponde al número de categórías.</li>
<li><strong>embedding_dim</strong>: El número de dimensiones en el cual se quiere representar.</li>
</ul>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>Este proceso tiene parámetros entrenables asociados.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="normalización" class="slide level2">
<h2>Normalización</h2>
<blockquote>
<p>En general el término Normalización está muy trillado y en la práctica se utiliza para referirse a muchos temas distintos. Algunas definiciones conocidas:</p>
</blockquote>
<div class="columns">
<div class="column">
<h3 id="normalización-1">Normalización</h3>
<p><span class="math display">\[x_{i\_norm} = \frac{x_i-x_{min}}{x_{max} - x_{min}}\]</span> Esta operación se puede hacer mediante <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html">MinMaxScaler</a> de Scikit-Learn.</p>
</div><div class="column">
<h3 id="estandarización">Estandarización</h3>
<p><span class="math display">\[ x_{i\_est} = \frac{x_i - E[x]}{\sqrt(Var[x])}\]</span></p>
<p>Esta operación se puede hacer mediante <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">StandardScaler</a> de Scikit-Learn.</p>
</div></div>
</section>
<section id="normalización-batch-norm" class="slide level2 smaller">
<h2>Normalización (Batch Norm)</h2>
<p><a href="https://arxiv.org/pdf/1502.03167">Paper 2015: Batch Normalization</a></p>
<div style="font-size: 90%;">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>¿Por qué?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Acelera el entrenamiento</li>
<li>Disminuye la importancia de los Parámetros iniciales.</li>
<li>Regulariza el modelo (un poquito)</li>
<li>Resuelve el problema de <a href="https://machinelearning.wtf/terms/internal-covariate-shift/">Internal Covariate Shift</a>.</li>
</ul>
</div>
</div>
</div>
</div>
<h4 id="ejemplo-supongamos-que-dado-la-altura-y-la-edad-queremos-predecir-si-será-deportista-de-alto-rendimiento.">Ejemplo: Supongamos que dado la altura y la edad queremos predecir si será deportista de alto rendimiento.</h4>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/normalize.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="img/clase-6/normalize.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/nn_example.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="img/clase-6/nn_example.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div></div>
</section>
<section id="normalización-batch-norm-1" class="slide level2 smaller">
<h2>Normalización (Batch Norm)</h2>
<div class="columns" style="font-size: 90%;">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/normalize.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="img/clase-6/normalize.png" class="quarto-figure quarto-figure-center" style="width:80.0%"></a></p>
</figure>
</div>
</div><div class="column">
<ul>
<li>Cambios en Altura son mucho más pequeños que en Edad debido al rango.</li>
<li>Toma más tiempo optimizar (requiere parámetros más pequeños)</li>
<li>Si el learning rate es alto puede diverger.</li>
<li>Si el learning rate es bajo implica que demora mucho más en converger.</li>
</ul>
</div></div>
<div class="columns fragment" style="font-size: 110%;">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/post_normalize.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="img/clase-6/post_normalize.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></a></p>
</figure>
</div>
</div><div class="column">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Pros</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Sin importar el punto inicial, el mínimo se encuentra <strong>casi</strong> a la misma distancia.<br>
</li>
<li>Es posible utilizar un learning rate más grande sin miedo a diverger.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cons</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Más cálculos y parámetros involucrados</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="normalización-batch-norm-2" class="slide level2 smaller">
<h2>Normalización (Batch Norm)</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/batch_norm_nn.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="img/clase-6/batch_norm_nn.png" class="quarto-figure quarto-figure-center" style="width:58.0%"></a></p>
</figure>
</div>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/Z1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="img/clase-6/Z1.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></a></p>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/Z2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="img/clase-6/Z2.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></a></p>
</figure>
</div>
</div></div>
</section>
<section id="normalización-batch-norm-3" class="slide level2 smaller">
<h2>Normalización (Batch Norm)</h2>
<div class="columns">
<div class="column">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cálculo de Estadísticos</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[ \mu_B = \frac{1}{B} \sum_{i=1}^B z^{(i)} = \frac{1}{3}(4 + 7 + 5) = 5.33\]</span> <span class="math display">\[ \sigma_B^2 = \frac{1}{B} \sum_{i=1}^B (z^{(i)} - \mu_B)^2 = 1.555\]</span></p>
</div>
</div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Normalización</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\widehat{z^{(i)}} = \frac{z^{(i)} - \mu_B}{\sqrt{\sigma_B^2 + \epsilon}}\]</span></p>
</div>
</div>
</div>
<div class="fragment" data-fragment-index="1">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Scale and Shift: <span class="math inline">\(\gamma\)</span> y <span class="math inline">\(\beta\)</span> son parámetros.</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[BN_{\gamma,\beta}(z_i)= \gamma \widehat{z_i} + \beta \]</span></p>
</div>
</div>
</div>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/batch_norm_nn.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="img/clase-6/batch_norm_nn.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></a></p>
</figure>
</div>
<h4 id="z2-norm">Z2 norm</h4>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/Z2_norm.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="img/clase-6/Z2_norm.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></a></p>
</figure>
</div>
<div class="fragment" data-fragment-index="1">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Donde <span class="math inline">\(\gamma\)</span> y <span class="math inline">\(\beta\)</span> son parámetros aprendidos durante el entrenamiento.</p>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="normalización-batch-norm-test-time" class="slide level2 smaller">
<h2>Normalización (Batch Norm): Test Time</h2>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Problema</strong></p>
</div>
<div class="callout-content">
<p>La predicción de una instancia <span class="math inline">\(i\)</span> específica, ahora depende de otros elementos dentro del Batch. <strong><em>¿Cómo funciona entonces el modelo en Test Time?</em></strong></p>
</div>
</div>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Se estiman valores de <span class="math inline">\(\mu_B\)</span> y <span class="math inline">\(\sigma_B\)</span> para usar en inferencia basados en los valores obtenidos en entrenamiento.</p>
</div>
</div>
</div>
<div class="columns">
<div class="column">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Estimación de Estadísticos</strong></p>
</div>
<div class="callout-content">
<ul>
<li><span class="math inline">\(\mu_B^{inf} = E[\mu_B^{j}]\)</span>, <span class="math inline">\(j = 1,...,B\)</span></li>
<li><span class="math inline">\(\sigma_B^{inf} = \frac{m}{m-1}E[\mu_B^{j}]\)</span>, <span class="math inline">\(j = 1,...,B\)</span></li>
</ul>
</div>
</div>
</div>
</div><div class="column">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Normalización</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\widehat{z^{(i)}} = \frac{z^{(i)} - \mu_B^{inf}}{\sqrt{(\sigma_B^{inf})^2 + \epsilon}}\]</span></p>
</div>
</div>
</div>
</div></div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Scale and Shift: <span class="math inline">\(\gamma\)</span> y <span class="math inline">\(\beta\)</span> son parámetros.</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[BN_{\gamma,\beta}(z_i)= \gamma \widehat{z_i} + \beta \]</span></p>
</div>
</div>
</div>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Los parámetros <span class="math inline">\(\gamma\)</span> y <span class="math inline">\(\beta\)</span> son los aprendidos durante el proceso de entrenamiento.</p>
</div>
</div>
</div>
</section>
<section id="normalización-batch-norm-consejos" class="slide level2 smaller">
<h2>Normalización (Batch Norm): Consejos</h2>
<ul>
<li>Andrew Ng propone utilizar BatchNorm justo antes de la función de Activacion.</li>
<li>El paper original también propone su uso justo antes de la activación.</li>
<li>Francoise Chollet, creador de Keras dice que los autores del paper en realidad lo utilizaron después de la función de activación.</li>
<li>Adicionalmente existen benchmarks que muestran mejoras usando BatchNorm después de las funciones de activación.</li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Entonces, la posición del BatchNorm termina siendo parte de la Arquitectura, y se debe comprobar donde tiene un mejor efecto.</p>
</div>
</div>
</div>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Batchnorm tiene efectos distintos al momento de entrenar o de evaluar/predecir en un modelo. Por lo tanto, de usar Batchnorm es imperativo utilizar los modos <code>model.train()</code> y <code>model.eval()</code> de manera apropiada.</p>
</div>
</div>
</div>
</section>
<section id="normalización-layer-norm" class="slide level2 smaller">
<h2>Normalización: Layer Norm</h2>
<p><a href="https://arxiv.org/abs/1607.06450">Paper 2016: Layer Normalization</a></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Batch Norm tiene algunos problemas:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Muy difícil de calcular en datos secuenciales (lo veremos más adelante).</li>
<li>Inestable cuando el Batch Size es muy pequeño.</li>
<li>Difícil de Paralelizar.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Beneficios de Layer Norm</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Puede trabajar con secuencias.</li>
<li>No tiene problemas para trabajar con cualquier tipo de Batch Size.</li>
<li>Se puede paralelizar, lo cuál es útil en redes como las RNN.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>En este caso se realiza la normalización por <strong>capa</strong> o por <strong>Data Point</strong> (instancia).</li>
<li>Además son el elementos cruciales en las Arquitecturas de Transformers.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="normalización-layer-norm-1" class="slide level2 smaller">
<h2>Normalización: Layer Norm</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/Z1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img data-src="img/clase-6/Z1.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/Z2_ly.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="img/clase-6/Z2_ly.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div><div class="column fragment">
<p><span class="math display">\[ \mu_{norm} = \frac{1}{n_i} \sum_{j=1}^{n_i} z_j = \frac{1}{4}(4 + 9 + 6 + 7) = 6.5\]</span> <span class="math display">\[ \sigma_{norm}^2 = \frac{1}{n_i} \sum_{j=1}^{n_i} (z_j - \mu_B)^2 = 3.25\]</span></p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Normalización</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\widehat{z_j} = \frac{z_j - \mu_{norm}}{\sqrt{\sigma_{norm}^2 + \epsilon}}\]</span></p>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/Z2_post_ly.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="img/clase-6/Z2_post_ly.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</div></div>
</section>
<section id="regularización-l2-aka-weight-decay" class="slide level2 smaller">
<h2>Regularización L2 aka Weight Decay</h2>
<p><a href="https://proceedings.neurips.cc/paper/1991/file/8eefcfdf5990e441f0fb6f3fad709e21-Paper.pdf">Paper 1991: Weight Decay</a></p>
<div style="font-size: 80%;">
<blockquote>
<p>En general el gran problema de las Redes Neuronales es el <strong><em>Overfitting</em></strong>. Esto porque las redes neuronales normalmente se denominan como <strong>Overparametrized Models</strong>. <strong><em>¿Qué significa esto?</em></strong></p>
</blockquote>
<dl>
<dt>Weight Decay</dt>
<dd>
<blockquote>
<p>Corresponde a una penalización que se da a los modelos para limitar su complejidad y asegurar que pueda generalizar correctamente en datos no vistos.</p>
</blockquote>
</dd>
</dl>
<p><span class="math display">\[ \underset{W_{i:L}}{minimize} \frac{1}{m} \sum_{i=1}^m l(h_\theta(x^{(i)}),y^{(i)}) + \frac{\lambda}{2} \sum_{i=1}^L ||W_i||_f^2\]</span></p>
<p>Eso implica una transformación a nuestro <strong><em>Update Rule</em></strong>:</p>
<p><span class="math display">\[W_i := W_i - \alpha \nabla \frac{1}{m} \sum_{i=1}^m l(h_\theta(x^{(i)}),y^{(i)}) - \alpha \lambda W_i = (1-\alpha\lambda)W_i - \alpha \nabla l(h_\theta(x^{(i)}),y^{(i)})\]</span></p>
</div>
<div class="columns">
<div class="column">
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Se puede ver que los pesos (weights) se <strong><em>contraen</em></strong> (decaen) antes de actualizarse en la dirección del gradiente.</p>
</div>
</div>
</div>
</div><div class="column">
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Por alguna razón Pytorch decidió implementarlo como una propiedad de los <strong><em>Optimizers</em></strong> cuando en realidad debió ser de la Loss Function.</p>
</div>
</div>
</div>
</div></div>
</section>
<section id="dropout" class="slide level2 smaller">
<h2>Dropout</h2>
<p><a href="https://paperswithcode.com/paper/dropout-a-simple-way-to-prevent-neural">Paper 2014: Dropout</a></p>
<div style="font-size: 80%;">
<blockquote>
<p>A diferencia de la estrategia anterior, este tipo de regularización se aplica a las activaciones de la red (resultados de la Transformación Affine, previo a la transformación no lineal).</p>
</blockquote>
<p>Definiremos el Dropout como:</p>
<p><span class="math display">\[Z_{i+1} = \sigma(W_i^T Z_i + b_i)\]</span> <span class="math display">\[\widehat{Z_{i+1}} = D(Z_{i+1})\]</span></p>
<p>donde <span class="math inline">\(D\)</span> implica la aplicación de Dropout a la capa <span class="math inline">\(i+1\)</span>. El elemento <span class="math inline">\(j\)</span> de la capa <span class="math inline">\(\widehat{Z_i}\)</span> se calcula como:</p>
<p><span class="math display">\[(\widehat{Z_{i+1}})_j = \begin{cases}
\frac{(Z_{i+1})_j}{1-p}  &amp; \text{with prob 1-p} \\
0, &amp; \text{with prob p}
\end{cases}\]</span></p>
<p><span class="math inline">\(p\)</span> se conoce como el <code>Dropout Rate</code>.</p>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>El factor <span class="math inline">\(\frac{1}{1-p}\)</span> se aplica para mantener la varianza estable luego de haber eliminado activaciones con probabilidad <span class="math inline">\(p\)</span>.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Dropout se aplica normalmente al momento de entrenar el modelo. Por lo tanto, de usar Dropout es imperativo cambiar al modo <code>model.eval()</code> al momento de predecir.</p>
</div>
</div>
</div>
</section>
<section id="weights-initialization" class="slide level2 smaller">
<h2>Weights Initialization</h2>
<p><a href="https://proceedings.mlr.press/v9/glorot10a/glorot10a.pdf">Paper 2010: Xavier Initialization</a> <a href="https://arxiv.org/abs/1502.01852">Paper 2015: Kaiming Initialization</a></p>
<p>Hemos hablado que los métodos basados en SGD normalmente utilizan valores aleatorios para partir su entrenamiento, lo cual deja un poco al azar el éxito de un proceso de entrenamiento.</p>
<p>Existen diversos estudios de cómo <code>inicializar</code> los parámetros para una convergencia óptima. Algunas de las inicializaciones son:</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Activaciones Triviales</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Constante</li>
<li>Sólo unos</li>
<li>Sólo Zeros</li>
</ul>
</div>
</div>
</div>
</section>
<section id="weights-initialization-1" class="slide level2 smaller">
<h2>Weights Initialization</h2>
<div class="columns">
<div class="column">
<h4 id="xavier-o-glorot-uniforme">Xavier o Glorot Uniforme</h4>
<p>Se inicia con valores provenientes de una distribución uniforme: <span class="math inline">\(\mathcal{U}(-a,a)\)</span></p>
<p><span class="math display">\[ a = gain \cdot \sqrt{\frac{6}{fan_{in} + fan_{out}}}\]</span></p>
</div><div class="column">
<h4 id="xavier-o-glorot-normal">Xavier o Glorot Normal</h4>
<p>Se inicia con valores provenientes de una distribución uniforme: <span class="math inline">\(\mathcal{N}(0,std^2)\)</span></p>
<p><span class="math display">\[ std = gain \cdot \sqrt{\frac{2}{fan_{in} + fan_{out}}}\]</span></p>
</div></div>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li><span class="math inline">\(fan_{in}\)</span> corresponde al número de conexiones que entran a una neurona. Mientras que <span class="math inline">\(fan_{out}\)</span> corresponde al número de neuronas que salen de dicha neurona.</li>
<li><span class="math inline">\(fan\_mode\)</span> corresponde a la elección de <span class="math inline">\(fan_{in}\)</span> o <span class="math inline">\(fan_{out}\)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="columns">
<div class="column">
<h4 id="kaiming-aka-he-uniforme">Kaiming (aka He) Uniforme</h4>
<p>Se inicia con valores provenientes de una distribución uniforme: <span class="math inline">\(\mathcal{U}(-bound,bound)\)</span></p>
<p><span class="math display">\[ bound = gain \cdot \sqrt{\frac{3}{fan\_mode}}\]</span></p>
</div><div class="column">
<h4 id="kaiming-aka-he-normal">Kaiming (aka He) Normal</h4>
<p>Se inicia con valores provenientes de una distribución uniforme: <span class="math inline">\(\mathcal{N}(0,std^2)\)</span></p>
<p><span class="math display">\[std =\sqrt{\frac{gain}{fan\_mode}}\]</span></p>
</div></div>
</section>
<section id="training-control" class="slide level2 smaller">
<h2>Training Control</h2>
<p>El entrenamiento de una red neuronal puede tomar mucho tiempo. Es por eso que algunas buenas prácticas serían:</p>
<ul>
<li>Disponer de resultados preliminares aunque el entrenamiento no haya terminado.</li>
<li>Guardar los pesos del mejor modelo obtenido en el proceso de entrenamiento.</li>
<li>Evitar entrenar pasado el punto de Overfitting.
<ul>
<li>Aunque hay nuevas ideas de lo que se llama el <a href="https://www.linkedin.com/feed/update/urn:li:activity:7214966566696718336?updateEntityUrn=urn%3Ali%3Afs_updateV2%3A%28urn%3Ali%3Aactivity%3A7214966566696718336%2CFEED_DETAIL%2CEMPTY%2CDEFAULT%2Cfalse%29">grokking</a>.</li>
</ul></li>
</ul>
<div class="columns">
<div class="column">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Early Stopping</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Se refiere al proceso de detener el entrenamiento luego de <code>patience</code> epochs sin mejorar el validation loss u otro criterio.</li>
</ul>
</div>
</div>
</div>
</div><div class="column">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Checkpointing</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Corresponde al proceso de guardar los parámetros obtenidos en un epoch en específico. Normalmente se guarda la mejor epoch y la última, pero se puede generar algún criterio.</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="categorical-variables" class="slide level2 smaller">
<h2>Categorical Variables</h2>
<blockquote>
<p>Es importante mencionar que normalmente no se utilizan redes neuronales para poder entrenar datos tabulares. Pero de hacerlo, es muy probable que nos encontremos con variables categóricas. Para ello existen dos técnicas que son las más comunes en redes neuronales.</p>
</blockquote>
<dl>
<dt>One Hot Encoder</dt>
<dd>
Corresponde a la representación mediante dummy variables. Normalmente se considera una representación <code>Sparse</code> de los datos.
</dd>
</dl>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>En Pytorch se puede implementar como <code>F.one_hot()</code>, pero mi recomendación es utilizar las herramientas de Scikit-Learn para evitar <code>Data Leakage</code>.</p>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="img/clase-6/one_hot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img data-src="img/clase-6/one_hot.png" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
</section>
<section id="thats-all-folks" class="title-slide slide level1 center">
<h1>That’s all Folks</h1>
<div class="footer">
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
</p><p><span property="dct:title">Tics-579 Deep Learning</span> por Alfonso Tobar-Arancibia está licenciado bajo <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0</a></p><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a>
<p></p>
</div>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../logo-uai-blanco.jpeg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'fast',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1366,

        height: 768,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/datacubeR\.github\.io\/clases_UAI\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>